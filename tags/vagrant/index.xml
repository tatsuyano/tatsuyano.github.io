<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Vagrant on blog.10rane.com</title>
    <link>http://tatsuyano.github.io/tags/vagrant/</link>
    <description>Recent content in Vagrant on blog.10rane.com</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Fri, 28 Aug 2015 19:00:00 +0900</lastBuildDate>
    <atom:link href="http://tatsuyano.github.io/tags/vagrant/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>package化したboxを使うときによく出るエラー</title>
      <link>http://tatsuyano.github.io/2015/08/28/errors-out-when-using-to-package-the-box/</link>
      <pubDate>Fri, 28 Aug 2015 19:00:00 +0900</pubDate>
      
      <guid>http://tatsuyano.github.io/2015/08/28/errors-out-when-using-to-package-the-box/</guid>
      <description>

&lt;p&gt;&lt;code&gt;vagrant package&lt;/code&gt;コマンドでパッケージ化したboxで仮想環境を作成(&lt;code&gt;vagrant up&lt;/code&gt;)するさいによく出るエラーをまとめました。&lt;/p&gt;

&lt;h2 id=&#34;an-error-occurred-while-downloading-the-remote-file-モートファイルのダウンロード中にエラーが発生しました:cce2e29dfeda9f5936787415d1f692b6&#34;&gt;An error occurred while downloading the remote file(モートファイルのダウンロード中にエラーが発生しました)&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;An error occurred while downloading the remote file. The error
message, if any, is reproduced below. Please fix this error and try
again.

Couldn&#39;t open file xxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;解決方法&lt;/em&gt;&lt;br&gt;
パッケージ(コピー)元のboxと同じ設定のbox(パッケージ化したboxで生成した仮想環境)がバッティングしている？
パッケージ元の仮想環境を&lt;code&gt;vagrant destroy&lt;/code&gt;して削除する。
&lt;br&gt;&lt;br&gt;&lt;/p&gt;

&lt;h2 id=&#34;authentication-failure-retrying-認証の失敗-再試行:cce2e29dfeda9f5936787415d1f692b6&#34;&gt;Authentication failure. Retrying&amp;hellip;(認証の失敗。再試行)&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;    default: SSH username: vagrant
    default: SSH auth method: private key
    default: Warning: Connection timeout. Retrying...
    default: Warning: Authentication failure. Retrying...
    default: Warning: Authentication failure. Retrying...
    default: Warning: Authentication failure. Retrying...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;解決方法&lt;/em&gt;&lt;br&gt;
&lt;code&gt;vagrant up&lt;/code&gt;したさいに生成される秘密鍵と、パッケージしたbox(ゲストOS)に設定してある公開鍵がマッチしないためにエラーになる。
&lt;code&gt;vagrant ssh-config&lt;/code&gt;で表示される秘密鍵から公開鍵を生成し、公開鍵を設定する。&lt;/p&gt;

&lt;p&gt;1.秘密鍵を確認&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant ssh-config
...
  IdentityFile xxxx/vagrant_private_key
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.公開鍵を生成&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssh-keygen -yf xxxx/vagrant_private_key &amp;gt; public_key
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3.ゲストOSに生成した公開鍵を設定する&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant ssh

vagrant at localhost in ~
$ vi /home/vagrant/.ssh/authorized_keys # 生成した公開鍵を設定する
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;参考サイト:cce2e29dfeda9f5936787415d1f692b6&#34;&gt;参考サイト&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://qiita.com/megane42/items/1d8ae7444d8c1b10bbd7&#34;&gt;Vagrant で作った VM にやってはいけない2つのこと&lt;/a&gt;
&lt;br&gt;&lt;br&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;the-following-ssh-command-responded-with-a-non-zero-exit-status-sshコマンドがゼロ以外の終了ステータスで応答しました:cce2e29dfeda9f5936787415d1f692b6&#34;&gt;The following SSH command responded with a non-zero exit status(SSHコマンドがゼロ以外の終了ステータスで応答しました)&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;The following SSH command responded with a non-zero exit status.
Vagrant assumes that this means the command failed!

ARPCHECK=no /sbin/ifup eth1 2&amp;gt; /dev/null

Stdout from the command:

Device eth1 does not seem to be present, delaying initialization.


Stderr from the command:
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;解決方法&lt;/em&gt;&lt;/br&gt;
MACアドレスとのマッピングを無効にし、再起動&lt;code&gt;vagrant reload&lt;/code&gt;する。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant ssh

vagrant at localhost in ~
$ sudo ln -s -f /dev/null /etc/udev/rules.d/70-persistent-net.rules
$ exit

$ vagrant reload
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;参考サイト-1:cce2e29dfeda9f5936787415d1f692b6&#34;&gt;参考サイト&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://qiita.com/tarr1124/items/8276e609c0f7cdec79e7&#34;&gt;macで作られたvagrant boxをもらったときに出るネットワークエラーの対処法&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.monochromegane.com/blog/2013/04/06/vagrant-network-error/&#34;&gt;Vagrantのネットワークが起動しないときは&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>vagrant-aws-pluginをインストール</title>
      <link>http://tatsuyano.github.io/2014/07/21/install-vagrant-aws-plugin/</link>
      <pubDate>Mon, 21 Jul 2014 03:00:00 +0900</pubDate>
      
      <guid>http://tatsuyano.github.io/2014/07/21/install-vagrant-aws-plugin/</guid>
      <description>

&lt;p&gt;vagrant-awsプラグインを使うことで、コマンドラインで
インスタンスの作成、起動ができるようになります。&lt;/p&gt;

&lt;h3 id=&#34;vagrant-aws-plugin-のインストール:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;vagrant-aws(plugin)のインストール&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant plugin install vagrant-aws
Installing the &#39;vagrant-aws&#39; plugin. This can take a few minutes...
Installed the plugin &#39;vagrant-aws (0.4.1)&#39;!
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;インストールされているpluginの確認:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;インストールされているpluginの確認&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant plugin list
vagrant-aws (0.4.1)
vagrant-login (1.0.1, system)
vagrant-share (1.0.1, system)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;boxのインストール:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;BOXのインストール&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant box add dummy https://github.com/mitchellh/vagrant-aws/raw/master/dummy.box
==&amp;gt; box: Adding box &#39;dummy&#39; (v0) for provider:
    box: Downloading: https://github.com/mitchellh/vagrant-aws/raw/master/dummy.box
    ==&amp;gt; box: Successfully added box &#39;dummy&#39; (v0) for &#39;aws&#39;!
$ vagrant box list
chef/centos-6.5 (virtualbox, 1.0.0)
dummy           (aws, 0)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;aws用のディレクトリを作成-初期化:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;aws用のディレクトリを作成 &amp;amp; 初期化&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ mkdir -p Vagrant/Aws
$ cd Vagrant/Aws
$ vagrant init dummy
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;access-key-idとsecret-access-keyの設定:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;Access_Key_IDとSecret_Access_Keyの設定&lt;/h3&gt;

&lt;p&gt;自分のアカウントのIDとKeyを設定するか、
もしくはIAMでユーザを作成し、そのユーザのIDとKeyを設定する&lt;/p&gt;

&lt;h4 id=&#34;自分のアカウントのidとkey:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;自分のアカウントのIDとKey&lt;/h4&gt;

&lt;p&gt;&lt;img width=&#34;70%&#34; src=&#34;https://dl.dropboxusercontent.com/u/159938/blog_images/aws_ec2_12.png&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;iamのidとkey:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;IAMのIDとKey&lt;/h4&gt;

&lt;p&gt;&lt;img width=&#34;70%&#34; src=&#34;https://dl.dropboxusercontent.com/u/159938/blog_images/aws_ec2_10.png&#34; /&gt;
&lt;img width=&#34;70%&#34; src=&#34;https://dl.dropboxusercontent.com/u/159938/blog_images/aws_ec2_11.png&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;vagrantfileの設定:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;Vagrantfileの設定&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;VAGRANTFILE_API_VERSION = &amp;quot;2&amp;quot;
Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  config.vm.box = &amp;quot;dummy&amp;quot;
  config.vm.provider :aws do |aws, override|
    aws.access_key_id = &#39;XXXX&#39;
    aws.secret_access_key = &#39;XXXX&#39;
    aws.region = &amp;quot;ap-northeast-1&amp;quot; # Tokyo
    aws.ami = &#39;ami-c9562fc8&#39; # Amazon Linux AMI 2014.03.1
    aws.instance_type = &#39;t1.micro&#39;
    aws.security_groups = [&#39;XXXX&#39;] # 複数設定可
    aws.keypair_name = &#39;XXXX&#39; # 事前に作成した秘密鍵
    aws.tags = {
      &#39;Name&#39; =&amp;gt; &#39;XXXX&#39;
    }
    override.ssh.username = &amp;quot;ec2-user&amp;quot;
    override.ssh.private_key_path = &#39;DLした秘密鍵のフルパス&#39;
  end
end
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;インスタンスの起動:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;インスタンスの起動&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant up --provider=aws
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;インスタンスへの接続:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;インスタンスへの接続&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant ssh
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;参考サイト:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;参考サイト&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://qiita.com/Humangas/items/2997cc6701aa90687c04&#34;&gt;Vagrantで AWS EC2インスタンス（RHEL5.5）を作成する&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://qiita.com/yuma_iwasaki/items/817d54cf075a67778a0a&#34;&gt;vagrant-awsを使用する際のVagrantファイル詳細&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/IAM_Introduction.html&#34;&gt;IAM とは?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://qiita.com/tuboc/items/38da97cb96b2ebc69f88#1-5&#34;&gt;EC2インスタンス作成＆最初にしたこと&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;関連する記事:fd8b071654156cd5d19727f6c2bcdb56&#34;&gt;関連する記事&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.10rane.com/2014/07/21/install-vagrant-and-virtualbox/&#34;&gt;VagrantとVirtualBoxのインストール&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.10rane.com/2014/07/21/start-aws/&#34;&gt;aws はじめました。&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>VagrantとVirtualBoxのインストール</title>
      <link>http://tatsuyano.github.io/2014/07/21/install-vagrant-and-virtualbox/</link>
      <pubDate>Mon, 21 Jul 2014 01:00:00 +0900</pubDate>
      
      <guid>http://tatsuyano.github.io/2014/07/21/install-vagrant-and-virtualbox/</guid>
      <description>

&lt;p&gt;今回はVagrantが1.5.4、VirtualBoxが4.3.10をインストール&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.vagrantup.com/downloads.html&#34;&gt;DOWNLOAD VAGRANT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.virtualbox.org/wiki/Downloads&#34;&gt;Download VirtualBox&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;boxのインストール:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;BOXのインストール&lt;/h2&gt;

&lt;p&gt;新しくできた&lt;a href=&#34;https://vagrantcloud.com/discover/featured&#34;&gt;VAGRANT CLOUD&lt;/a&gt;にあるBOXをインストール&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant add chef/centos-6.5
1) virtualbox
2) hyperv
Enter your choice: 1
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;仮想マシンを作る:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;仮想マシンを作る&lt;/h2&gt;

&lt;h3 id=&#34;まずは設定ファイルを置くためのディレクトリを掘る:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;まずは設定ファイルを置くためのディレクトリを掘る&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ mkdir -p ~/Vagrant/CentOS65
$ cd /Vagrant/CentOS65
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;インストールされているboxの確認:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;インストールされているBOXの確認&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant box list
$ chef/centos-6.5 (virtualbox, 1.0.0)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;初期化と起動:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;初期化と起動&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant init chef/centos-6.5
$ vagrant up
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;仮想マシンへの接続:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;仮想マシンへの接続&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant ssh
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;仮想マシンのipを固定にする:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;仮想マシンのIPを固定にする&lt;/h3&gt;

&lt;p&gt;Vagrantfileのconfig.vm.networkをコメントインする&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ grep -ir &amp;quot;private_network&amp;quot; ~/Vagrant/Centos65/Vagrantfile
/$HOME/Vagrant/Centos65/Vagrantfile:  # config.vm.network &amp;quot;private_network&amp;quot;, ip: &amp;quot;192.168.33.10&amp;quot;
$ vagrant reload
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;sshの設定を保存し-ホスト名でログインできるようにする:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;SSHの設定を保存し、ホスト名でログインできるようにする&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ cd ~/Vagrant/Centos65
$ vagrant ssh-config &amp;gt;&amp;gt; ~/.ssh/config
ssh default &amp;lt;- 追加した状態だとhost名が&#39;default&#39;なので、後で変える
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;それ以外のコマンド:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;それ以外のコマンド&lt;/h3&gt;

&lt;p&gt;仮想マシンの削除&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant box remove chef/centos-6.5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ステータスの確認&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ vagrant status
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;参考サイト:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;参考サイト&lt;/h2&gt;

&lt;p&gt;以下のサイトを参考にさせていただきました。ありがとうございます！&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://qiita.com/inouet/items/b36638adc2b5772db457&#34;&gt;Vagrant セットアップ (Mac)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://shindolog.hatenablog.com/entry/2013/04/15/235731&#34;&gt;Vagrant のコマンドをメモしておく&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;関連する記事:691a8f9bf65a866d03438cfc2d34fceb&#34;&gt;関連する記事&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.10rane.com/2014/07/21/start-aws/&#34;&gt;aws はじめました。&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.10rane.com/2014/07/21/install-vagrant-and-virtualbox/&#34;&gt;VagrantとVirtualBoxのインストール&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>